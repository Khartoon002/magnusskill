<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Magnus Personal Dashboard | Magnus Platform</title>

  <!-- Fonts & Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --bg:#0B0B0D; --panel:#121214; --card-dark:#1E1F22; --card-brown:#3A2A22;
      --text:#FFFFFF; --text-dim:#C8C8CC;
      --accent-orange1:#FF8A1A; --accent-orange2:#FF5A00;
      --accent-green:#2CC65C; --accent-green-d:#179444; --accent-red:#D12B2B;
      --chip-amber:#FFB44C; --shadow:rgba(0,0,0,0.45);
    }
    html,body{height:100%;background:#1b1b1d;}
    body{
      font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      margin:0;overflow:hidden;height:100svh;
      color:var(--text);
    }
    * { box-sizing: border-box; }
    .text-main{color:var(--text);} .text-dim{color:var(--text-dim);}
    .orangrad{background:linear-gradient(135deg,var(--accent-orange1),var(--accent-orange2));}
    .ring-soft{box-shadow: inset 0 0 0 1px rgba(255,255,255,.08), 0 12px 24px -10px var(--shadow);}
    .shadow-soft{box-shadow:0 20px 36px -18px var(--shadow);}
    .grain:before{content:"";position:absolute;inset:0;border-radius:inherit;pointer-events:none;
      background:repeating-linear-gradient(125deg,rgba(255,255,255,.035) 0 2px,transparent 2px 6px),
                 radial-gradient(1200px 400px at 20% -60%,rgba(255,255,255,.06),transparent 60%),
                 radial-gradient(800px 240px at 120% 0,rgba(255,255,255,.05),transparent 60%);
      mix-blend-mode:overlay;opacity:.32;
    }
    .inner-glow:after{content:"";position:absolute;inset:0;border-radius:inherit;pointer-events:none;
      background:radial-gradient(140% 120% at 50% 20%, rgba(255,140,64,.25), transparent 55%),
                 radial-gradient(120% 140% at 50% 100%, rgba(255,90,0,.18), transparent 55%);
    }
    .chip{border-radius:9999px;padding:.25rem .6rem;font-weight:700;font-size:clamp(.66rem,.5rem + .4vw,.76rem);letter-spacing:.2px;}
    .pill{border-radius:9999px;padding:.35rem .7rem;font-weight:700;font-size:clamp(.72rem,.6rem + .5vw,.85rem);}
    .btn{border-radius:9999px;padding:.65rem 1.1rem;font-weight:700;display:inline-flex;align-items:center;justify-content:center;gap:.4rem;}
    .btn-ghost{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);}
    .btn-orange{background:linear-gradient(135deg,var(--accent-orange1),var(--accent-orange2));color:#111;}
    .progress-track{height:14px;border-radius:9999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);}
    .progress-bar{height:100%;border-radius:9999px;}
    .selector-circle{width:30px;height:30px;border-radius:9999px;border:2px solid rgba(255,255,255,.28);display:inline-flex;align-items:center;justify-content:center;}
    .selector-checked{background:linear-gradient(135deg,var(--accent-orange1),var(--accent-orange2));border:none;color:#111;}
    .vignette{box-shadow: inset 0 0 0 1px rgba(255,255,255,.06), 0 30px 40px -26px #000;}
    .card-radius{border-radius:22px;}
    .nav-pill{border-radius:28px;}
    .ios-homebar{width:120px;height:6px;border-radius:9999px;background:white;opacity:.92;}
    .tight{letter-spacing:-.6px;}
    .container{width:100vw;height:100svh;display:grid;place-items:center;overflow:hidden;}
    .frame{
      width:100vw; max-width:100vw;
      border-radius: clamp(14px, 4vw, 28px);
      padding: clamp(10px, 3.5vw, 24px);
      padding-top: calc(env(safe-area-inset-top) + clamp(10px, 3.5vw, 24px));
      padding-left: calc(env(safe-area-inset-left) + clamp(10px, 3.5vw, 24px));
      padding-right: calc(env(safe-area-inset-right) + clamp(10px, 3.5vw, 24px));
      background: var(--panel);
      margin: 0;
      box-shadow: 0 25px 60px -20px rgba(0,0,0,.65), 0 0 0 1px rgba(255,255,255,.06) inset;
      transform-origin: top left;
    }
    .currency{font-size:clamp(24px, 4vw, 36px);} .h2{font-size:clamp(20px, 3.2vw, 28px);}
    .coll{display:grid;grid-template-rows:0fr;transition:grid-template-rows .28s ease,opacity .28s ease;}
    .coll.open{grid-template-rows:1fr;} .coll > div{overflow:hidden;}
    .coll-fade{opacity:0;transition:opacity .28s ease;} .coll.open .coll-fade{opacity:1;}
    .stack-gap-1{height:clamp(8px,2.2vh,18px);} .stack-gap-2{height:clamp(8px,2vh,14px);} .stack-gap-3{height:clamp(10px,2.4vh,18px);}
    .avatar{width:42px;height:42px;border-radius:9999px;background:linear-gradient(135deg,var(--accent-orange1),var(--accent-orange2));box-shadow:0 6px 14px -8px rgba(0,0,0,.55), inset 0 0 0 2px rgba(255,255,255,.25);cursor:pointer;}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:.5rem;flex-wrap:wrap;}
    .topbar-right{display:flex;align-items:center;gap:.5rem;min-width:0;flex:1;justify-content:flex-end;flex-wrap:nowrap;}
    .hours-pill{display:flex;align-items:center;gap:.35rem;padding:.28rem .5rem;border-radius:9999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.1);}
    .hours-text div{white-space:nowrap;line-height:1;}
    .badge-count{display:grid;place-items:center;width:24px;height:24px;border-radius:9999px;background:linear-gradient(135deg,var(--accent-orange1),var(--accent-orange2));color:#111;font-weight:800;font-size:12px;}
    .hamb-btn{width:38px;height:38px;border-radius:10px;background:rgba(255,255,255,.08);display:grid;place-items:center;}
  </style>
</head>
<body>
  <div class="container">
    <main id="frame" class="frame text-main relative">
      <!-- Top Bar -->
      <header class="topbar mb-3">
        <div class="flex items-center gap-3 min-w-0">
          <div class="avatar" id="openApplyAvatar" title="Tap to edit your details"></div>
          <div class="text-white font-extrabold text-[clamp(15px,3vw,20px)] tight truncate" id="welcomeName">
            Hi, Magnus User!
          </div>
        </div>
        <div class="topbar-right">
          <div class="hours-pill">
            <div class="grid place-items-center w-7 h-7 rounded-xl bg-white/8 flex-none">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <rect x="3" y="8" width="18" height="11" rx="2" stroke="#C8C8CC" stroke-width="1.6"></rect>
                <path d="M9 8V6a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" stroke="#C8C8CC" stroke-width="1.6" stroke-linecap="round"/>
              </svg>
            </div>
            <div class="hours-text pr-2">
              <div class="text-[11px] text-dim leading-none">Today</div>
              <div class="text-[12px] font-semibold -mt-0.5">Study Hours</div>
            </div>
            <div class="badge-count" id="hoursBadge">0</div>
          </div>
          <button class="hamb-btn" aria-label="Menu">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M4 7h16M4 12h16M4 17h16" stroke="#C8C8CC" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
      </header>

      <!-- Money Card -->
      <section class="relative orangrad card-radius p-5 sm:p-6 shadow-soft vignette overflow-hidden">
        <div class="absolute right-0 top-0 w-[42%] h-[42%] rounded-tr-[22px] bg-[#2a2a2c] opacity-35 translate-x-2 -translate-y-2 rotate-[18deg]"></div>
        <div class="flex items-center gap-2 relative">
          <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-white/90 text-[#111]">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M4 7h16a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2Z" stroke="#111" stroke-width="1.6" />
              <circle cx="12" cy="12" r="3.2" stroke="#111" stroke-width="1.6"/>
            </svg>
          </span>
          <span class="font-semibold text-[13px] text-black/90">Total Study Value (Demo)</span>
        </div>
        <div class="mt-3 sm:mt-4 relative">
          <div class="text-white currency font-extrabold tight drop-shadow-[0_2px_1px_rgba(0,0,0,.2)]">
            NGN179,992.80
          </div>
          <p class="mt-1 text-[11px] text-black/80 max-w-xs">
            Example of what your skills can generate when you stay consistent with learning & resale.
          </p>
        </div>
        <button class="mt-3 inline-flex items-center gap-2 bg-white/92 text-[#111] font-semibold rounded-full px-4 py-2 text-[12px]">
          <span>Log today&apos;s hours</span>
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
            <path d="M6 9l6 6 6-6" stroke="#111" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </section>

      <div class="stack-gap-1"></div>

      <!-- Section Title -->
      <div class="flex items-center justify-between">
        <h2 class="text-white h2 font-extrabold">Your Magnus Skills</h2>
        <button aria-label="Close" class="w-8 h-8 rounded-lg bg-white/10 grid place-items-center">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M6 6l12 12M18 6 6 18" stroke="#C8C8CC" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <div class="stack-gap-2"></div>

      <!-- Card 1 -->
      <article id="card1" data-key="DATA" class="relative bg-[#1E1F22] grain card-radius p-4 sm:p-5 ring-soft shadow-soft text-main overflow-hidden">
        <div class="flex items-start gap-3">
          <div class="selector-circle shrink-0"></div>
          <div class="flex-1 min-w-0">
            <div class="flex items-start justify-between gap-3">
              <div class="pill bg-[#ff8a1a1a] text-[#111] ring-1 ring-white/15 orangrad-hr">
                Data Analysis
              </div>
              <div class="text-right">
                <div class="text-dim text-sm leading-tight">Skill value (hr):</div>
                <div class="text-[clamp(18px,3.4vw,22px)] font-extrabold text-white tight">₦3,865</div>
              </div>
            </div>
            <div class="mt-3">
              <div class="progress-track relative">
                <div class="progress-bar" style="width:78%; background:linear-gradient(90deg,var(--accent-green),var(--accent-green-d)); box-shadow:inset 0 0 0 1px rgba(0,0,0,.25);"></div>
                <span class="absolute -top-3 left-[62%] translate-x-0 chip text-[10.5px]"
                      style="background:linear-gradient(90deg,var(--accent-green),var(--accent-green-d)); color:#0b2213; border:1px solid rgba(0,0,0,.15);">
                  78% complete
                </span>
              </div>
            </div>
            <button class="mt-3 inline-flex items-center gap-1 text-dim text-[13px] see-btn" data-target="#benefits1">
              <span>See learning roadmap</span>
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                <path d="M6 9l6 6 6-6" stroke="#C8C8CC" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <div id="benefits1" class="coll mt-2">
              <div class="coll-fade">
                <ul class="text-[13px] text-dim list-disc pl-5 space-y-1.5">
                  <li>Finish your portfolio dashboard this week.</li>
                  <li>Join 1 live review session with your mentor.</li>
                  <li>Post 1 case study as content to attract clients.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </article>

      <div class="stack-gap-2"></div>

      <!-- Card 2 -->
      <article id="card2" data-key="MAGNUS-BUSINESS" class="relative bg-[#3A2A22] inner-glow grain card-radius p-4 sm:p-5 ring-soft shadow-soft text-main overflow-hidden">
        <div class="absolute left-1/2 -top-3 -translate-x-1/2 chip"
             style="background:var(--chip-amber); color:#3a2500; box-shadow:0 6px 14px -8px rgba(0,0,0,.45);">
          Your Entry Plan
        </div>
        <div class="flex items-start gap-3">
          <div class="selector-circle selector-checked shrink-0">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M6 12l4 4 8-8" stroke="#111" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="flex-1 min-w-0">
            <div class="flex items-start justify-between gap-3">
              <div class="pill bg-[#2b1d17] text-white ring-1 ring-white/10" id="entryPlanPill">
                Magnus Business – ₦28,500
              </div>
              <div class="text-right">
                <div class="text-dim text-sm leading-tight">Target:</div>
                <div class="text-[clamp(18px,3.4vw,22px)] font-extrabold text-white tight">
                  ₦300k / month
                </div>
              </div>
            </div>
            <div class="mt-3">
              <div class="progress-track relative" style="background:rgba(255,80,60,.08); border-color:rgba(255,255,255,.06);">
                <div class="progress-bar" style="width:16%; background:linear-gradient(90deg,#6e0d0d,var(--accent-red)); opacity:.9;"></div>
              </div>
            </div>
            <button class="mt-3 inline-flex items-center gap-1 text-dim text-[13px] see-btn" data-target="#benefits2">
              <span>See how to grow this month</span>
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                <path d="M6 9l6 6 6-6" stroke="#C8C8CC" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <div id="benefits2" class="coll mt-2">
              <div class="coll-fade">
                <ul class="text-[13px] text-dim list-disc pl-5 space-y-1.5">
                  <li>Close 1–3 high-ticket Business plan registrations weekly.</li>
                  <li>Host 2 mini Zoom/Telegram classes about Magnus.</li>
                  <li>Turn your dashboard into content: screenshots + results.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </article>

      <div class="stack-gap-2"></div>

      <!-- Selected + Actions -->
      <div class="divider" style="height:1px;background:linear-gradient(90deg,transparent,rgba(200,200,204,.25),transparent);"></div>
      <div class="flex items-center justify-between pt-3">
        <div>
          <div class="text-dim text-[14px]">Currently Focused Skill</div>
          <div id="selectedValue" class="text-[clamp(18px,3.2vw,20px)] font-extrabold" style="color:var(--accent-orange1);">
            MAGNUS-BUSINESS
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button class="btn btn-orange text-[13px]">
            Learn
          </button>
          <button class="btn btn-ghost text-main text-[13px]">
            Resale
          </button>
        </div>
      </div>

      <div class="mt-4 flex items-center justify-between">
        <div class="flex items-center gap-2">
          <button id="dec" class="w-9 h-9 rounded-full bg-white/10 grid place-items-center">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M6 12h12" stroke="#C8C8CC" stroke-width="2.2" stroke-linecap="round"/>
            </svg>
          </button>
          <div id="qty" class="w-10 h-10 rounded-full bg:white/10 bg-white/10 grid place-items-center text-main font-semibold select-none">
            1
          </div>
          <button id="inc" class="w-9 h-9 rounded-full bg-white/10 grid place-items-center">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M12 6v12M6 12h12" stroke="#C8C8CC" stroke-width="2.2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
        <div class="flex items-center gap-2">
          <button class="w-9 h-9 rounded-full bg-white/10 grid place-items-center">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="2" fill="#C8C8CC"/><circle cx="5" cy="12" r="2" fill="#C8C8CC"/><circle cx="19" cy="12" r="2" fill="#C8C8CC"/>
            </svg>
          </button>
          <button class="w-9 h-9 rounded-full bg-white/10 grid place-items-center" id="openPaymentShortcut" title="Go to payment">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none">
              <path d="M7 7h10l-1 13H8L7 7Z" stroke="#C8C8CC" stroke-width="1.7"/>
              <path d="M5 7h14" stroke="#C8C8CC" stroke-width="1.7" stroke-linecap="round"/>
              <path d="M9 7V5h6v2" stroke="#C8C8CC" stroke-width="1.7" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="stack-gap-3"></div>

      <!-- Bottom Nav -->
      <nav class="orangrad nav-pill shadow-soft px-6 py-4 text-[#111] grid grid-cols-4 gap-2">
        <button class="grid place-items-center w-full h-10 rounded-full bg-white/10" title="Home">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M4 10.5 12 4l8 6.5V20a1.5 1.5 0 0 1-1.5 1.5H5.5A1.5 1.5 0 0 1 4 20v-9.5Z" stroke="#111" stroke-width="1.8"/>
            <path d="M9 21v-6h6v6" stroke="#111" stroke-width="1.8"/>
          </svg>
        </button>
        <button class="grid place-items-center w-full h-10 rounded-full bg-white/10" title="Search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <circle cx="11" cy="11" r="6" stroke="#111" stroke-width="1.8"/>
            <path d="M20 20l-3.5-3.5" stroke="#111" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
        </button>
        <button class="grid place-items-center w-full h-10 rounded-full bg-white/10" title="Tasks">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M4 5h2l2.5 11H18l2-8H7" stroke="#111" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="10" cy="20" r="1.4" fill="#111"/><circle cx="17" cy="20" r="1.4" fill="#111"/>
          </svg>
        </button>
        <button class="grid place-items-center w-full h-10 rounded-full bg-white/10" title="Profile">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="8" r="3.2" stroke="#111" stroke-width="1.8"/>
            <path d="M4.8 20c1.6-3.6 12.8-3.6 14.4 0" stroke="#111" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
        </button>
      </nav>

      <div class="mt-3 w-full flex justify-center">
        <div class="ios-homebar"></div>
      </div>
    </main>
  </div>

  <!-- ====================== APPLY / PAYMENT MODALS ====================== -->

  <!-- APPLY NOW MODAL -->
  <div id="applyOverlay" class="fixed inset-0 z-[60] bg-black/70 backdrop-blur-sm hidden items-center justify-center p-4">
    <form id="applyForm" class="w-full max-w-md bg-[#121214] text:white text-white rounded-2xl shadow-2xl ring-1 ring-white/10 p-6 space-y-4 relative">
      <button type="button" id="closeApply" class="absolute top-3 right-3 w-7 h-7 rounded-full bg-white/5 hover:bg-white/10 grid place-items-center text-[14px] text-dim">
        ×
      </button>
      <div class="text-center">
        <h1 class="text-2xl font-extrabold">Open Your Magnus Dashboard</h1>
        <p class="text-sm text-[#C8C8CC] mt-1">
          Fill these details once so your personal Magnus dashboard and payment verification can be tied to you.
        </p>
      </div>
      <div class="space-y-1">
        <label for="fullName" class="text-sm font-semibold">Full name</label>
        <input id="fullName" name="fullName" type="text" required
               class="w-full rounded-xl bg-white/10 ring-1 ring-white/10 focus:ring-2 focus:ring-[#FF8A1A] outline-none px-3 py-3 placeholder-white/40 text-sm"
               placeholder="e.g. Janet Okafor" />
      </div>
      <div class="space-y-1">
        <label for="phone" class="text-sm font-semibold">WhatsApp number</label>
        <input id="phone" name="phone" type="tel" required
               class="w-full rounded-xl bg-white/10 ring-1 ring-white/10 focus:ring-2 focus:ring-[#FF8A1A] outline-none px-3 py-3 placeholder-white/40 text-sm"
               placeholder="e.g. 0707 162 7074" />
      </div>
      <div class="space-y-1">
        <label for="email" class="text-sm font-semibold">Email</label>
        <input id="email" name="email" type="email" required
               class="w-full rounded-xl bg:white/10 bg-white/10 ring-1 ring-white/10 focus:ring-2 focus:ring-[#FF8A1A] outline-none px-3 py-3 placeholder-white/40 text-sm"
               placeholder="e.g. janet@example.com" />
      </div>

      <!-- Plan dropdown -->
      <div class="space-y-1">
        <label for="applyPlan" class="text-sm font-semibold">Preferred Magnus Entry Plan (Magnus Pro is recommended)</label>
        <select id="applyPlan" name="applyPlan"
                class="w-full rounded-xl bg:white/10 bg-white/10 ring-1 ring-white/10 focus:ring-2 focus:ring-[#FF8A1A] outline-none px-3 py-3 text-sm">
          <option value="Lite">Magnus Lite – ₦11,000 (Starter)</option>
          <option value="Pro" selected>Magnus Pro – ₦17,500 (Most Popular / Recommended)</option>
          <option value="Business">Magnus Business – ₦28,500 (Heavy Earner)</option>
        </select>
      </div>

      <button type="submit"
              class="w-full orangrad text-[#111] font-extrabold rounded-2xl px-4 py-3 shadow-soft text-[13px]">
        Save &amp; Continue to Payment
      </button>
      <p class="text-[11px] text-center text-[#C8C8CC]">
        Your details are stored securely on this device to keep your dashboard personalized.
      </p>
    </form>
  </div>

  <!-- PAYMENT METHOD MODAL -->
  <div id="paymentMethodModal" class="fixed inset-0 z:[70] z-[70] hidden items-center justify-center bg-black/70 backdrop-blur-sm p-4">
    <div class="w-full max-w-sm bg-[#121214] text-white rounded-2xl shadow-2xl ring-1 ring-white/10 overflow-hidden">
      <div class="flex items-center justify-between px-6 py-4 border-b border-white/10">
        <h3 class="text-lg font-extrabold">Choose Payment Method</h3>
      </div>
      <div class="px-6 py-5 space-y-4">
        <p class="text-sm text-white/70">Select how you want to pay for your Magnus entry plan.</p>
        <div class="space-y-3">
          <!-- OPay -->
          <button type="button" data-pay-method="opay" class="w-full flex items-center justify-between rounded-xl bg-[#22c55e1a] hover:bg-[#22c55e33] px-4 py-3">
            <div class="flex items-center gap-3">
              <span class="w-9 h-9 rounded-full bg-[#22C55E] grid place-items-center font-bold text-[#111] text-xs">OP</span>
              <div class="text-left">
                <div class="font-semibold text-sm">OPay Bank</div>
                <div class="text-xs text-white/70">For OPay users only</div>
              </div>
            </div>
            <span class="text-xs font-semibold text-white/80">Use</span>
          </button>

          <!-- Other Banks -->
          <button type="button" data-pay-method="bank" class="w-full flex items-center justify-between rounded-xl bg-white/5 hover:bg-white/10 px-4 py-3">
            <div class="flex items-center gap-3">
              <span class="w-9 h-9 rounded-full bg:white/90 bg-white/90 grid place-items-center">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <rect x="3" y="7" width="18" height="11" rx="2" stroke="#111" stroke-width="1.4"/>
                  <path d="M3 11h18" stroke="#111" stroke-width="1.4" stroke-linecap="round"/>
                  <path d="M9 5h6" stroke="#111" stroke-width="1.4" stroke-linecap="round"/>
                </svg>
              </span>
              <div class="text-left">
                <div class="font-semibold text-sm">Other Banks</div>
                <div class="text-xs text-white/70">Normal bank transfer</div>
              </div>
            </div>
            <span class="text-xs font-semibold text-white/80">Use</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- PAYMENT CARD MODAL -->
  <div id="payfacPaymentModal" class="fixed inset-0 z-[80] hidden items-center justify-center bg-black/70 backdrop-blur-sm p-4">
    <div class="w-full max-w-md bg-[#121214] text:white text-white rounded-2xl shadow-2xl ring-1 ring-white/10 overflow-hidden">
      <div class="flex items-center justify-between px-6 py-4 border-b border-white/10">
        <h3 class="text-lg font-extrabold">Complete Your Setup</h3>
        <button id="closePaymentModal" class="px-3 py-1 text-sm rounded-lg bg-white/10 hover:bg-white/15">Close</button>
      </div>
      <div class="px-6 py-5 space-y-3" id="paymentCardBody">
        <p class="text-sm">
          Hi <span id="pfUserName" class="font-bold">there</span>, pay to this account to get started with Magnus.
        </p>
        <p class="text-xs text-dim">
          Please transfer the exact amount for your selected plan. Keep your screenshot — you will submit it as proof.
        </p>

        <!-- Account + Amount Grid -->
        <div class="grid grid-cols-1 gap-2 text-sm">
          <div class="flex items-center justify-between bg-white/5 rounded-xl p-3 ring-1 ring-white/10">
            <div>
              <div class="text-white/70">Account number</div>
              <div class="font-bold" id="pfAcctNo">6054080105</div>
            </div>
            <button class="ml-3 text-xs bg-white/10 hover:bg-white/15 rounded-lg px-3 py-2" data-copy-target="#pfAcctNo">Copy</button>
          </div>
          <div class="flex items-center justify-between bg-white/5 rounded-xl p-3 ring-1 ring-white/10">
            <div>
              <div class="text-white/70">Account Name</div>
              <div class="font-bold" id="pfAcctName">Spino Clinton</div>
            </div>
            <button class="ml-3 text-xs bg-white/10 hover:bg-white/15 rounded-lg px-3 py-2" data-copy-target="#pfAcctName">Copy</button>
          </div>
          <div class="flex items-center justify-between bg-white/5 rounded-xl p-3 ring-1 ring-white/10">
            <div>
              <div class="text-white/70">Bank</div>
              <div class="font-bold" id="pfBank">Moniepoint</div>
            </div>
            <button class="ml-3 text-xs bg-white/10 hover:bg-white/15 rounded-lg px-3 py-2" data-copy-target="#pfBank">Copy</button>
          </div>
          <div class="flex items-center justify-between bg-white/5 rounded-xl p-3 ring-1 ring-white/10">
            <div>
              <div class="text-white/70">Amount to pay</div>
              <div class="font-extrabold" id="pfAmount">₦0</div>
            </div>
            <button class="ml-3 text-xs bg-white/10 hover:bg-white/15 rounded-lg px-3 py-2" data-copy-target="#pfAmount">Copy</button>
          </div>
          <div class="flex items-center justify-between bg-white/5 rounded-xl p-3 ring-1 ring-white/10">
            <div>
              <div class="text-white/70">Payment duration</div>
              <div class="font-semibold" id="pfDuration">
                Pay now to lock your entry fee before any price increase. You start earning immediately after activation.
              </div>
              <div class="text-xs text-[#FF8A1A] mt-1" id="countdownTimer">01:00:00</div>
            </div>
          </div>
        </div>

        <!-- PLAN DROPDOWN INSIDE PAYMENT POPUP -->
        <div class="space-y-1 text-xs mt-3">
          <label for="pfPlanSelect" class="text-white/80 font-semibold">
            Change your Magnus plan here (Magnus Pro is recommended)
          </label>
          <select id="pfPlanSelect"
                  class="w-full rounded-xl bg-white/10 ring-1 ring-white/10 focus:ring-2 focus:ring-[#FF8A1A] outline-none px-3 py-2 text-xs">
            <option value="Lite">Magnus Lite – ₦11,000 (Starter)</option>
            <option value="Pro">Magnus Pro – ₦17,500 (Recommended)</option>
            <option value="Business">Magnus Business – ₦28,500 (Heavy Earner)</option>
          </select>
        </div>

        <div class="pt-3 text-center">
          <button id="submitPaymentProof" class="orangrad text-[#111] font-extrabold rounded-2xl px-5 py-3 shadow-soft text-[13px]">
            Submit Payment Proof
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- SUBMIT PROOF OPTIONS MODAL -->
  <div id="submitOptionsModal" class="fixed inset-0 z-[90] hidden items-center justify-center bg-black/70 backdrop-blur-sm p-4">
    <div class="w-full max-w-sm bg-[#121214] text-white rounded-2xl shadow-2xl ring-1 ring-white/10 overflow-hidden">
      <div class="flex items-center justify-between px-6 py-4 border-b border-white/10">
        <h3 class="text-lg font-extrabold">Choose how to submit</h3>
        <button type="button" id="closeSubmitOptions" class="px-3 py-1 text-sm rounded-lg bg-white/10 hover:bg-white/15">Close</button>
      </div>
      <div class="px-6 py-5 space-y-4">
        <p class="text-sm text-white/70">
          Select Telegram, Email or WhatsApp. Your details and payment summary will be filled in automatically.
        </p>
        <div class="space-y-3">
          <button type="button" data-submit-channel="telegram" class="w-full flex items-center justify-between rounded-xl bg-[#229ED91a] hover:bg-[#229ED933] px-4 py-3">
            <div class="flex items-center gap-3">
              <span class="w-9 h-9 rounded-full bg-[#229ED9] grid place-items-center">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M20.5 4.5 3.8 11.2c-.7.3-.7 1.1-.1 1.4L8 14.8l1.8 4c.3.7 1.2.7 1.5 0l1.7-3.4 4.3 2.9c.6.4 1.4.1 1.6-.6l2.1-12.1c.1-.7-.5-1.2-1.3-.9Z" stroke="#111" stroke-width="1.3" stroke-linejoin="round"/>
                  <path d="m9 15 7-7-8.5 5" stroke="#111" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </span>
              <div class="text-left">
                <div class="font-semibold text-sm">Telegram</div>
                <div class="text-xs text-white/70">Send via Telegram chat</div>
              </div>
            </div>
            <span class="text-xs font-semibold text-white/80">Use</span>
          </button>

          <button type="button" data-submit-channel="email" class="w-full flex items-center justify-between rounded-xl bg-white/5 hover:bg-white/10 px-4 py-3">
            <div class="flex items-center gap-3">
              <span class="w-9 h-9 rounded-full bg-white/90 grid place-items-center">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <rect x="3" y="5" width="18" height="14" rx="2" stroke="#111" stroke-width="1.4"/>
                  <path d="M5 7.5 12 12l7-4.5" stroke="#111" stroke-width="1.4" stroke-linecap="round"/>
                </svg>
              </span>
              <div class="text-left">
                <div class="font-semibold text-sm">Email</div>
                <div class="text-xs text-white/70">Send as a detailed email</div>
              </div>
            </div>
            <span class="text-xs font-semibold text-white/80">Use</span>
          </button>

          <button type="button" data-submit-channel="whatsapp" class="w-full flex items-center justify-between rounded-xl bg-[#25d3661a] hover:bg-[#25d36633] px-4 py-3">
            <div class="flex items-center gap-3">
              <span class="w-9 h-9 rounded-full bg-[#25D366] grid place-items-center">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 3a9 9 0 0 0-9 9c0 1.6.4 3.1 1.2 4.4L3 21l4.8-1.2A9 9 0 1 0 12 3Z" stroke="#111" stroke-width="1.4"/>
                  <path d="M9.5 9.2c-.2-.6-.5-.6-.8-.6h-.6c-.2 0-.6.1-.9.4-.3.3-1.1 1-1.1 2.5 0 1.5 1.1 3 1.3 3.2.2.2 2.1 3.2 5.1 4.3 2.5 1 3 1 3.5.9.5-.1 1.7-.7 1.9-1.4.2-.7.2-1.3.1-1.4-.1-.1-.2-.1-.5-.2s-1.7-.8-1.9-.9c-.2-.1-.4-.1-.6.1-.2.2-.7.9-.9 1-.2.1-.3.2-.6.1-.3-.1-1.3-.5-2.4-1.5-.9-.8-1.5-1.8-1.7-2.1-.2-.3 0-.5.1-.6.1-.1.3-.3.4-.5.1-.2.2-.3.3-.5.1-.2 0-.4 0-.5-.1-.1-.7-1.7-1-2.3Z" fill="#111"/>
                </svg>
              </span>
              <div class="text-left">
                <div class="font-semibold text-sm">WhatsApp</div>
                <div class="text-xs text-white/70">Chat a verified PayFac on WhatsApp</div>
              </div>
            </div>
            <span class="text-xs font-semibold text-white/80">Use</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ DASHBOARD JS (selection, qty, fit) + MODAL LOGIC ============ -->
  <script>
    // --- Course selection + qty logic (dashboard core) ---
    const card1 = document.getElementById('card1');
    const card2 = document.getElementById('card2');
    const selectedValue = document.getElementById('selectedValue');
    const selectCard = (card) => {
      [card1, card2].forEach(c => {
        const sc = c.querySelector('.selector-circle');
        if (c === card) {
          sc.classList.add('selector-checked');
          sc.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M6 12l4 4 8-8" stroke="#111" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"/></svg>';
          if (c === card2) c.classList.add('inner-glow'); else c.classList.remove('inner-glow');
        } else {
          sc.classList.remove('selector-checked');
          sc.innerHTML='';
          if (c !== card2) c.classList.remove('inner-glow');
        }
      });
      selectedValue.textContent = card.dataset.key || '';
    };
    selectCard(card2);
    card1.addEventListener('click', () => selectCard(card1));
    card2.addEventListener('click', () => selectCard(card2));

    document.querySelectorAll('.see-btn').forEach(btn => {
      const t = document.querySelector(btn.dataset.target);
      btn.addEventListener('click', e => {
        e.stopPropagation();
        t.classList.toggle('open');
      });
    });

    let qty = 1; const qtyEl = document.getElementById('qty');
    const renderQty = () => qtyEl.textContent = qty;
    document.getElementById('inc').onclick = e => { e.stopPropagation(); qty++; renderQty(); };
    document.getElementById('dec').onclick = e => { e.stopPropagation(); qty = Math.max(1, qty - 1); renderQty(); };

    // --- Perfect-fit width & height ---
    function fitToViewport(){
      const frame = document.getElementById('frame');
      const container = document.querySelector('.container');
      const dpr = window.devicePixelRatio || 1;

      frame.style.transform = 'scale(1)';
      frame.style.maxWidth = 'none';
      frame.style.width = '100vw';

      const availW = (window.visualViewport ? window.visualViewport.width  : window.innerWidth);
      const availH = (window.visualViewport ? window.visualViewport.height : window.innerHeight);

      const availWSnapped = Math.floor(availW * dpr) / dpr;
      const availHSnapped = Math.floor(availH * dpr) / dpr;

      const rect = frame.getBoundingClientRect();
      const neededW = rect.width;
      const neededH = rect.height;

      const scaleW = availWSnapped / neededW;
      const scaleH = (availHSnapped - 1 / dpr) / neededH;
      const scale = Math.min(1, scaleW, scaleH);

      const preWidth = Math.ceil((availWSnapped / scale) * dpr) / dpr;
      frame.style.width = preWidth + 'px';
      frame.style.transform = `scale(${scale})`;

      container.style.height = availHSnapped + 'px';
    }
    window.addEventListener('load', fitToViewport);
    window.addEventListener('resize', fitToViewport);
    if (window.visualViewport) visualViewport.addEventListener('resize', fitToViewport);
    window.addEventListener('orientationchange', () => setTimeout(fitToViewport, 200));

    // --- APPLY + PAYMENT MODALS (ported & adapted for dashboard) ---
    (function(){
      /* =====================================================
         CONTACT ROTATION CONFIG (EASY TO EDIT)
      ====================================================== */
      const CONTACT_ROTATION_ENABLED = true;              // Set false to stop auto-changing numbers
      const CONTACT_ROTATION_INTERVAL_MS = 5 * 60 * 1000; // Rotation duration: 5 minutes

      // WhatsApp numbers used for payment receipt (local format)
      const WHATSAPP_NUMBERS = [
        "09152304164",
        "07071627074"
      ];

      // Telegram numbers used for payment receipt (local format)
      const TELEGRAM_NUMBERS = [
        "07037195976",
        "09012345678"
      ];

      // Email remains fixed (edit if you like)
      const MAGNUS_EMAIL = "magnuswebsite@site.com";

      let currentWaIndex = 0;
      let currentTgIndex = 0;

      function localToWaLink(localNumber){
        if (!localNumber) return "#";
        const intl = "234" + localNumber.replace(/^0/, "");
        return "https://wa.me/" + intl;
      }
      function localToTgLink(localNumber){
        if (!localNumber) return "#";
        const intl = "234" + localNumber.replace(/^0/, "");
        return "https://t.me/" + intl;
      }

      function getCurrentWhatsAppLink(){
        const local = WHATSAPP_NUMBERS[currentWaIndex] || WHATSAPP_NUMBERS[0];
        return localToWaLink(local);
      }
      function getCurrentTelegramLink(){
        const local = TELEGRAM_NUMBERS[currentTgIndex] || TELEGRAM_NUMBERS[0];
        return localToTgLink(local);
      }

      function rotateContacts(){
        if (!CONTACT_ROTATION_ENABLED) return;
        if (WHATSAPP_NUMBERS.length > 0){
          currentWaIndex = (currentWaIndex + 1) % WHATSAPP_NUMBERS.length;
        }
        if (TELEGRAM_NUMBERS.length > 0){
          currentTgIndex = (currentTgIndex + 1) % TELEGRAM_NUMBERS.length;
        }
      }

      if (CONTACT_ROTATION_ENABLED && CONTACT_ROTATION_INTERVAL_MS > 0){
        setInterval(rotateContacts, CONTACT_ROTATION_INTERVAL_MS);
      }

      // ================== DASHBOARD + MODAL LOGIC ==================
      const applyOverlay = document.getElementById('applyOverlay');
      const closeApplyBtn = document.getElementById('closeApply');
      const openApplyAvatar = document.getElementById('openApplyAvatar');
      const applyForm = document.getElementById('applyForm');
      const welcomeEl = document.getElementById('welcomeName');
      const entryPlanPill = document.getElementById('entryPlanPill');
      const openPaymentShortcut = document.getElementById('openPaymentShortcut');
      const frameEl = document.getElementById('frame');

      const planAmountMap = {
        'Lite': '₦11,000',
        'Pro': '₦17,500',
        'Business': '₦28,500'
      };
      let selectedPlan = 'Pro';           // Default recommendation
      let selectedAmount = planAmountMap[selectedPlan];

      function setWelcomeName(name){
        if (!welcomeEl) return;
        welcomeEl.textContent = 'Hi, ' + name + '!';
      }

      function showApply(){
        if (!applyOverlay) return;
        applyOverlay.classList.remove('hidden');
        applyOverlay.classList.add('flex');
      }
      function hideApply(){
        if (!applyOverlay) return;
        applyOverlay.classList.add('hidden');
        applyOverlay.classList.remove('flex');
      }

      if (openApplyAvatar){
        openApplyAvatar.addEventListener('click', function(e){
          e.stopPropagation();
          showApply();
        });
      }
      if (closeApplyBtn){
        closeApplyBtn.addEventListener('click', function(e){
          e.stopPropagation();
          hideApply();
        });
      }
      if (applyOverlay){
        applyOverlay.addEventListener('click', function(e){
          if (e.target === applyOverlay) hideApply();
        });
      }

      const applyPlanSel = document.getElementById('applyPlan');
      const fullNameInput = document.getElementById('fullName');
      const phoneInput = document.getElementById('phone');
      const emailInput = document.getElementById('email');

      // Prefill from localStorage
      try{
        const savedName = localStorage.getItem('magnus_apply_fullname');
        const savedPhone = localStorage.getItem('magnus_apply_phone');
        const savedEmail = localStorage.getItem('magnus_apply_email');
        const savedPlan = localStorage.getItem('magnus_apply_plan');

        if (savedName && fullNameInput){ fullNameInput.value = savedName; setWelcomeName(savedName); }
        if (savedPhone && phoneInput){ phoneInput.value = savedPhone; }
        if (savedEmail && emailInput){ emailInput.value = savedEmail; }
        if (savedPlan && applyPlanSel){
          applyPlanSel.value = savedPlan;
          selectedPlan = savedPlan;
          selectedAmount = planAmountMap[selectedPlan] || '₦0';
          if (entryPlanPill){
            entryPlanPill.textContent = `Magnus ${selectedPlan} – ${selectedAmount}`;
          }
        }
        if (!savedName){
          // First time visitor – show the Apply form immediately
          showApply();
        }
      }catch(_){}

      // Payment modals
      const payMethodModal = document.getElementById('paymentMethodModal');
      const payModal = document.getElementById('payfacPaymentModal');
      const closePayModalBtn = document.getElementById('closePaymentModal');
      const nameEl = document.getElementById('pfUserName');
      const amtEl = document.getElementById('pfAmount');
      const acctNoEl   = document.getElementById('pfAcctNo');
      const acctNameEl = document.getElementById('pfAcctName');
      const bankEl     = document.getElementById('pfBank');
      const pfPlanSelect = document.getElementById('pfPlanSelect');

      function showPayMethod(){
        if (!payMethodModal) return;
        payMethodModal.classList.remove('hidden');
        payMethodModal.classList.add('flex');
      }
      function hidePayMethod(){
        if (!payMethodModal) return;
        payMethodModal.classList.add('hidden');
        payMethodModal.classList.remove('flex');
      }
      function showPayModal(){
        if (!payModal) return;
        payModal.classList.remove('hidden');
        payModal.classList.add('flex');
      }
      function hidePayModal(){
        if (!payModal) return;
        payModal.classList.add('hidden');
        payModal.classList.remove('flex');
      }

      function openPaymentCard(){
        let name = 'there';
        try{
          name = localStorage.getItem('magnus_apply_fullname') || 'there';
          const storedPlan = localStorage.getItem('magnus_apply_plan');
          if (storedPlan) selectedPlan = storedPlan;
        }catch(_){}

        // Always fall back to Magnus Pro as recommended default
        if (!selectedPlan){
          selectedPlan = 'Pro';
        }
        selectedAmount = planAmountMap[selectedPlan] || '₦0';

        if (nameEl) nameEl.textContent = name;
        if (pfPlanSelect) pfPlanSelect.value = selectedPlan;
        if (amtEl) amtEl.textContent = selectedAmount;
        if (entryPlanPill){
          entryPlanPill.textContent = `Magnus ${selectedPlan} – ${selectedAmount}`;
        }

        showPayMethod();
      }
      window.openPaymentCard = openPaymentCard;

      if (openPaymentShortcut){
        openPaymentShortcut.addEventListener('click', function(e){
          e.preventDefault();
          e.stopPropagation();
          openPaymentCard();
        });
      }

      // APPLY FORM SUBMIT
      applyForm && applyForm.addEventListener('submit', function(e){
        e.preventDefault();
        const fullName = (fullNameInput.value || '').trim();
        const phone = (phoneInput.value || '').trim();
        const email = (emailInput.value || '').trim();
        const chosenPlan = (applyPlanSel && applyPlanSel.value) ? applyPlanSel.value : 'Pro';

        if (!fullName || !phone || !email) return;

        try{
          localStorage.setItem('magnus_apply_fullname', fullName);
          localStorage.setItem('magnus_apply_phone', phone);
          localStorage.setItem('magnus_apply_email', email);
          localStorage.setItem('magnus_apply_plan', chosenPlan);
        }catch(_){}

        setWelcomeName(fullName);
        selectedPlan = chosenPlan;
        selectedAmount = planAmountMap[selectedPlan] || '₦0';

        if (entryPlanPill){
          entryPlanPill.textContent = `Magnus ${selectedPlan} – ${selectedAmount}`;
        }

        hideApply();
        openPaymentCard();
      });

      // Handle plan change INSIDE payment popup
      if (pfPlanSelect){
        pfPlanSelect.addEventListener('change', function(){
          const newPlan = this.value || 'Pro';
          selectedPlan = newPlan;
          selectedAmount = planAmountMap[newPlan] || '₦0';

          if (amtEl) amtEl.textContent = selectedAmount;
          if (entryPlanPill){
            entryPlanPill.textContent = `Magnus ${selectedPlan} – ${selectedAmount}`;
          }
          try{
            localStorage.setItem('magnus_apply_plan', selectedPlan);
          }catch(_){}
        });
      }

      if (closePayModalBtn){
        closePayModalBtn.addEventListener('click', function(e){
          e.stopPropagation();
          hidePayModal();
        });
      }
      if (payModal){
        payModal.addEventListener('click', function(e){
          if (e.target === payModal) hidePayModal();
        });
      }

      const paymentMethods = {
        opay: {
          acctNo: '6416620475',
          acctName: 'Spino Clinton',
          bank: 'Opay Bank'
        },
        bank: {
          acctNo: acctNoEl ? acctNoEl.textContent.trim() : '6054080105',
          acctName: acctNameEl ? acctNameEl.textContent.trim() : 'Spino Clinton',
          bank: bankEl ? bankEl.textContent.trim() : 'Moniepoint'
        }
      };

      document.addEventListener('click', function(e){
        const btn = e.target.closest('[data-pay-method]');
        if (!btn) return;
        const methodKey = btn.getAttribute('data-pay-method');
        const cfg = paymentMethods[methodKey];
        if (!cfg) return;

        if (acctNoEl)   acctNoEl.textContent   = cfg.acctNo;
        if (acctNameEl) acctNameEl.textContent = cfg.acctName;
        if (bankEl)     bankEl.textContent     = cfg.bank;

        hidePayMethod();
        showPayModal();
      });

      // Copy buttons
      document.addEventListener('click', async function(e){
        const copyBtn = e.target.closest('button[data-copy-target]');
        if (!copyBtn) return;
        const sel = copyBtn.getAttribute('data-copy-target');
        const target = document.querySelector(sel);
        if (!target) return;
        const text = (target.textContent || '').trim();
        try{
          await navigator.clipboard.writeText(text);
          const original = copyBtn.textContent;
          copyBtn.textContent = 'Copied!';
          setTimeout(()=> copyBtn.textContent = original, 1200);
        }catch(_){
          alert('Copy failed. Long-press to copy manually.');
        }
      });

      // Submit payment proof -> options
      const submitBtn = document.getElementById('submitPaymentProof');
      const submitOptionsModal = document.getElementById('submitOptionsModal');
      const closeSubmitOptionsBtn = document.getElementById('closeSubmitOptions');

      submitBtn && submitBtn.addEventListener('click', function(e){
        e.stopPropagation();
        let name = 'there', phone = '', email = '';
        try{
          name = localStorage.getItem('magnus_apply_fullname') || 'there';
          phone = localStorage.getItem('magnus_apply_phone') || '';
          email = localStorage.getItem('magnus_apply_email') || '';
        }catch(_){}
        const plan = selectedPlan || (localStorage.getItem && localStorage.getItem('magnus_apply_plan')) || 'Not selected';
        const amount = selectedAmount || planAmountMap[plan] || '₦0';

        const acctNo = (acctNoEl && acctNoEl.textContent || '').trim();
        const acctName = (acctNameEl && acctNameEl.textContent || '').trim();
        const bank = (bankEl && bankEl.textContent || '').trim();
        const duration = (document.getElementById('pfDuration')?.textContent || '').trim();

        const msg =
`Hello Verified PayFac, please verify my Magnus payment.

Name: ${name}
Phone: ${phone}
Email: ${email}
Selected Plan: ${plan}
Amount: ${amount}

Payment account I used:
Account number: ${acctNo}
Account Name: ${acctName}
Bank: ${bank}

Extra note: ${duration}

I will now send my proof of payment (screenshot/file). Please help me activate my Magnus account.`;

        window.__magnusProofMsg = msg || '';

        if (submitOptionsModal){
          submitOptionsModal.classList.remove('hidden');
          submitOptionsModal.classList.add('flex');
        }
      });

      closeSubmitOptionsBtn && closeSubmitOptionsBtn.addEventListener('click', function(e){
        e.stopPropagation();
        submitOptionsModal.classList.add('hidden');
        submitOptionsModal.classList.remove('flex');
      });
      submitOptionsModal && submitOptionsModal.addEventListener('click', function(e){
        if (e.target === submitOptionsModal){
          submitOptionsModal.classList.add('hidden');
          submitOptionsModal.classList.remove('flex');
        }
      });

      document.addEventListener('click', function(e){
        const btn = e.target.closest('[data-submit-channel]');
        if (!btn) return;
        const channel = btn.getAttribute('data-submit-channel');
        const msg = window.__magnusProofMsg || '';
        if (!msg) return;

        submitOptionsModal.classList.add('hidden');
        submitOptionsModal.classList.remove('flex');

        if (channel === 'whatsapp'){
          const url = getCurrentWhatsAppLink() + "?text=" + encodeURIComponent(msg);
          window.location.href = url;
        } else if (channel === 'email'){
          const emailTo = MAGNUS_EMAIL;
          const subject = "Magnus Payment Proof Verification";
          const url = "mailto:" + emailTo + "?subject=" + encodeURIComponent(subject) + "&body=" + encodeURIComponent(msg);
          window.location.href = url;
        } else if (channel === 'telegram'){
          const url = getCurrentTelegramLink() + "?text=" + encodeURIComponent(msg);
          window.location.href = url;
        }
      });

      // Countdown when payment modal visible
      (function(){
        var timerEl = document.getElementById('countdownTimer');
        if (!timerEl || !payModal) return;

        function startCountdown(){
          var remaining = 3600;
          if (window._pfCountdown) clearInterval(window._pfCountdown);
          function update(){
            var h = String(Math.floor(remaining / 3600)).padStart(2,'0');
            var m = String(Math.floor((remaining % 3600) / 60)).padStart(2,'0');
            var s = String(remaining % 60).padStart(2,'0');
            timerEl.textContent = h + ":" + m + ":" + s;
            if (remaining <= 0){
              clearInterval(window._pfCountdown);
              timerEl.textContent = "Expired";
              timerEl.classList.add("text-red-400");
              return;
            }
            remaining--;
          }
          update();
          window._pfCountdown = setInterval(update, 1000);
        }

        var obs = new MutationObserver(function(){
          if (!payModal.classList.contains('hidden')){
            startCountdown();
          }
        });
        obs.observe(payModal, { attributes:true, attributeFilter:['class'] });
      })();

      /* ========================================================
         MAKE WHOLE DASHBOARD CLICKABLE
         --------------------------------------------------------
         Any click on the main dashboard "frame" opens:
         - Apply form first (if user has no saved details)
         - Payment popup afterwards.
      ======================================================== */
      if (frameEl){
        frameEl.addEventListener('click', function(e){
          const inOverlay = e.target.closest('#applyOverlay, #paymentMethodModal, #payfacPaymentModal, #submitOptionsModal');
          if (inOverlay) return;

          try{
            const savedName = localStorage.getItem('magnus_apply_fullname');
            if (!savedName){
              showApply();
            } else {
              openPaymentCard();
            }
          }catch(_){
            showApply();
          }
        });
      }

    })();
  </script>
</body>
</html>
